<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ATABS ROOM 18+</title>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: #0d0d0d; /* darker than modal */
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: white;
    }

    .modal {
      background-color: #1a1a1a; /* slightly lighter */
      color: white;
      border-radius: 16px;
      padding: 24px;
      width: 100%;
      max-width: 380px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      animation: fadeIn 1s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal img.profile {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 16px;
    }

    .modal h2 {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .modal p {
      font-size: 14px;
      margin-bottom: 16px;
      line-height: 1.3;
    }

    .progress-container {
      background: #333;
      height: 8px;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 16px;
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      background: #00aced;
      transition: width 0.3s ease;
    }

    .share-button {
      background-color: #0088cc;
      color: white;
      border: none;
      border-radius: 8px;
      width: 100%;
      padding: 10px 0;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
      transition: transform 0.1s ease;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      position: relative;
    }

    .share-button img {
      width: 16px;
      height: 16px;
    }

    .share-button:active {
      transform: scale(0.97);
    }

    .share-button:disabled {
      background-color: #555;
      cursor: not-allowed;
      filter: grayscale(100%);
    }

    .enter-button {
      background-color: #444;
      color: #aaa;
      border: none;
      border-radius: 8px;
      width: 100%;
      padding: 10px 0;
      cursor: not-allowed;
      font-weight: bold;
      font-size: 14px;
      margin-top: 12px;
      transition: background-color 0.3s ease, color 0.3s ease;
      filter: grayscale(100%);
    }

    .enter-button.unlocked {
      background-color: #00cc44;
      color: white;
      cursor: pointer;
      filter: none;
    }

    #message {
      margin-top: 12px;
      font-size: 13px;
      color: #f0a500;
      min-height: 18px;
      height: 18px;
    }

    @media (max-width: 500px) {
      .modal {
        padding: 18px;
      }

      .modal h2 {
        font-size: 16px;
      }

      .modal p {
        font-size: 13px;
      }

      .share-button,
      .enter-button {
        font-size: 13px;
      }
    }
  </style>
</head>
<body>
  <div class="modal" role="dialog" aria-labelledby="modalTitle" aria-describedby="modalDesc">
    <img src="https://i.ibb.co/Qq47T6j/IMG-5347.jpg" alt="Profile" class="profile" />
    <h2 id="modalTitle">ATABS ROOM 18+</h2>
    <p id="modalDesc">You must share in 3 groups to be <br> approved</p>

    <div class="progress-container" aria-label="Sharing progress">
      <div class="progress-bar" id="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="3" aria-valuenow="0"></div>
    </div>

    <button class="share-button" id="shareButton" aria-describedby="message" aria-live="polite" aria-atomic="true">
      <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" alt="Telegram Icon" />
      <span>SHARE (<span id="shareCount">0</span>/3) 🔒</span>
    </button>

    <button class="enter-button" id="enterButton" disabled>ENTER ATABS ROOM</button>

    <div id="message" role="alert" aria-live="assertive"></div>
  </div>

  <script>
    const totalShares = 3;
    let shareCount = 0;

    const shareButton = document.getElementById('shareButton');
    const enterButton = document.getElementById('enterButton');
    const shareCountText = document.getElementById('shareCount');
    const progressBar = document.getElementById('progressBar');
    const message = document.getElementById('message');

    // Function to update UI
    function updateUI() {
      shareCountText.textContent = shareCount;
      progressBar.style.width = (shareCount / totalShares) * 100 + '%';
      progressBar.setAttribute('aria-valuenow', shareCount);

      if (shareCount >= totalShares) {
        shareButton.disabled = true;
        enterButton.disabled = false;
        enterButton.classList.add('unlocked');
        message.textContent = '✅ You can now enter ATABS ROOM!';
      } else {
        shareButton.disabled = false;
        enterButton.disabled = true;
        enterButton.classList.remove('unlocked');
        message.textContent = '';
      }
    }

    // Function to simulate share and confirm user actually shared by timing the popup
    function handleShare() {
      // Open Telegram share link in new window
      const shareUrl = "https://t.me/share/url?url=https://t.me/PINAYFLEXPHboT?startapp=WatchNow";
      const shareWindow = window.open(shareUrl, '_blank', 'width=600,height=600');

      if (!shareWindow) {
        message.textContent = '⚠️ Please allow popups to share.';
        return;
      }

      message.textContent = "⚠️ Please don't close Telegram too quickly. Share to proceed.";
      let startTime = Date.now();

      const pollInterval = 500;
      const minShareTime = 3000; // 3 seconds minimum for share window open

      const timer = setInterval(() => {
        if (shareWindow.closed) {
          clearInterval(timer);
          const elapsed = Date.now() - startTime;

          if (elapsed >= minShareTime) {
            // Assume share success
            shareCount++;
            updateUI();

            if (shareCount === totalShares) {
              // Optional: Confetti or celebration animation here
            }
          } else {
            message.textContent = "⚠️ You closed the share too quickly. Please share properly.";
          }
        }
      }, pollInterval);
    }

    shareButton.addEventListener('click', () => {
      handleShare();
    });

    enterButton.addEventListener('click', () => {
      if (shareCount >= totalShares) {
        // User can enter now - redirect or show welcome message
        alert('Welcome to ATABS ROOM!');
        // window.location.href = 'https://your-landing-page.com'; // Example redirect
      }
    });

    // Initialize UI on page load
    updateUI();
  </script>
</body>
</html>
